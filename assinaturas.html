<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Assinaturas Growin — Builder</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif;margin:24px;color:#111}
  .wrap{display:grid;grid-template-columns:360px 1fr;gap:24px;align-items:start}
  label{display:block;font-size:12px;text-transform:uppercase;letter-spacing:.04em;color:#555;margin:12px 0 4px}
  input{width:100%;padding:10px 12px;border:1px solid #d0d0d0;border-radius:8px;font-size:14px}
  .card{border:1px solid #e6e6e6;border-radius:12px;padding:16px}
  .btn{display:inline-block;border:0;border-radius:10px;padding:12px 14px;font-weight:600;cursor:pointer}
  .btn-primary{background:#e6443b;color:#fff}
  .btn-ghost{background:#f6f6f6}
  .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
  .hint{font-size:12px;color:#666;margin-top:6px}
  .muted{color:#777}
  .preview-wrap{background:#fff;border:1px dashed #ddd;border-radius:12px;padding:16px;overflow:auto}
  .ok{color:#0a8a3a;font-weight:600}
  .err{color:#b00020}
  @media (max-width:900px){.wrap{grid-template-columns:1fr}}
</style>
</head>
<body>
<h1>Assinaturas Growin — Builder</h1>
<p class="muted">Campos personalizáveis: <strong>Nome</strong>, <strong>Cargo | Hobby</strong> e <strong>Telemóvel pessoal</strong>. O resto é fixo. Botões do Website e LinkedIn já apontam para os links oficiais.</p>

<div class="wrap">
  <!-- Formulário -->
  <div class="card">
    <label for="name">Nome</label>
    <input id="name" placeholder="Filipa Freire" value="Filipa Freire">

    <label for="title">Cargo</label>
    <input id="title" placeholder="GRAPHIC DESIGNER" value="GRAPHIC DESIGNER">

    <label for="hobby">Hobby</label>
    <input id="hobby" placeholder="Crochet Crafter" value="Crochet Crafter">

    <label for="mobile">Telemóvel pessoal (como deve aparecer)</label>
    <input id="mobile" placeholder="(+351) 934 556 060" value="(+351) 934 556 060">

    <label for="photo">URL da foto (PNG 240×240 já com aro/círculo)</label>
    <input id="photo" placeholder="https://growinassinaturas.github.io/email-signatures/headshot-filipa-freire.png" value="https://growinassinaturas.github.io/email-signatures/headshot-filipa-freire.png">

    <label for="assetHost">Host das imagens fixas (logo, ícones, selo)</label>
    <input id="assetHost" placeholder="https://growinassinaturas.github.io/email-signatures" value="https://growinassinaturas.github.io/email-signatures">

    <div class="row">
      <button id="copyBtn" class="btn btn-primary">Copiar assinatura</button>
      <button id="copyHtmlBtn" class="btn btn-ghost">Copiar HTML</button>
      <button id="linkBtn" class="btn btn-ghost">Gerar link desta assinatura</button>
    </div>
    <div id="status" class="hint"></div>
  </div>

  <!-- Preview -->
  <div>
    <div class="preview-wrap">
      <div id="preview"></div>
    </div>
    <p class="hint">1) Clica “Copiar assinatura” → 2) Cola em Gmail/Outlook/Apple Mail. (É só a <em>tabela</em>, com estilos inline, própria para e-mail).</p>
  </div>
</div>

<script>
  const qs = (s)=>document.querySelector(s);
  const encode = (s)=>encodeURIComponent(s ?? "");
  const digitsHref = (s)=> {
    const raw = (s||"").replace(/[^\d+]/g,"");
    if(/^9\d{8}$/.test(raw)) return "+351"+raw;
    return raw || "+3519XXXXXXXX";
  };

  function signatureHTML({name, title, hobby, mobile, photo, host}) {
    const telHref = digitsHref(mobile);
    const H = (host||"https://growinassinaturas.github.io/email-signatures").replace(/\/+$/,'');

    return `
<table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse; font-family: Arial, Helvetica, sans-serif; color:#333; -webkit-text-size-adjust:100%; mso-line-height-rule:exactly;">
  <tr>
    <td valign="top" style="padding:12px 16px 12px 0;">
      <img src="${photo}" width="120" height="120" alt="Foto de ${name}" style="display:block; border:0; outline:0; width:120px; height:120px;">
    </td>
    <td valign="top" style="padding:12px 24px 12px 0;">
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;">
        <tr><td style="font-size:22px; line-height:1.1; font-weight:800; color:#e6443b; padding:0 0 4px 0;">${name}</td></tr>
        <tr><td style="font-size:16px; line-height:1.25; font-weight:700; color:#555; padding:0 0 12px 0;">${title} | ${hobby}</td></tr>
        <tr>
          <td style="font-size:16px; line-height:1.3; color:#444; padding:0 0 6px 0;">
            <strong style="color:#e6443b;">T:</strong>
            <a href="tel:${telHref}" style="color:#444; text-decoration:none;">${mobile}</a>
          </td>
        </tr>
        <tr>
          <td style="font-size:14px; line-height:1.3; color:#666; padding:0 0 6px 0;">
            <img src="${H}/icon-telemovel.png" width="16" height="16" alt="" style="display:inline-block; vertical-align:-3px; border:0; margin-right:6px;">
            <a href="tel:+351215947950" style="color:#666; text-decoration:none;">(+351) 215 947 950</a>
          </td>
        </tr>
        <tr>
          <td style="font-size:14px; line-height:1.3; color:#666;">
            <img src="${H}/icon-local.png" width="16" height="16" alt="" style="display:inline-block; vertical-align:-3px; border:0; margin-right:6px;">
            Avenida da República, 57, 4.º andar, 1050-189, Lisbon
          </td>
        </tr>
      </table>
    </td>
    <td valign="middle" style="padding:0 24px 0 0;">
      <table role="presentation" height="120" cellpadding="0" cellspacing="0" border="0"><tr>
        <td style="border-left:2px solid #e6443b; font-size:0; line-height:0;">&nbsp;</td>
      </tr></table>
    </td>
    <td valign="top" style="padding:12px 0;">
      <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="border-collapse:collapse;">
        <tr>
          <td style="padding:0 0 12px 0;">
            <img src="${H}/growin-logo.png" width="160" height="40" alt="Growin" style="display:block; border:0; width:160px; height:40px;">
          </td>
        </tr>
        <tr>
          <td>
            <a href="https://www.growin.com/" target="_blank" style="text-decoration:none;">
              <img src="${H}/icon-website.png" width="32" height="32" alt="Website" style="display:inline-block; border:0; width:32px; height:32px; margin-right:8px;">
            </a>
            <a href="https://www.linkedin.com/company/growin/" target="_blank" style="text-decoration:none;">
              <img src="${H}/icon-linkedin.png" width="32" height="32" alt="LinkedIn" style="display:inline-block; border:0; width:32px; height:32px; margin-right:8px;">
            </a>
            <img src="${H}/certificacao-iso.png" width="120" height="48" alt="BSI ISO/IEC 27017" style="display:inline-block; border:0; width:120px; height:48px; vertical-align:middle;">
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>`;
  }

  const state = {
    name: qs("#name").value,
    title: qs("#title").value,
    hobby: qs("#hobby").value,
    mobile: qs("#mobile").value,
    photo: qs("#photo").value,
    host: qs("#assetHost").value
  };

  function readForm() {
    Object.assign(state, {
      name: qs("#name").value.trim() || "NOME APELIDO",
      title: qs("#title").value.trim() || "CARGO",
      hobby: qs("#hobby").value.trim() || "Hobby",
      mobile: qs("#mobile").value.trim() || "(+351) 9XX XXX XXX",
      photo: qs("#photo").value.trim() || "https://growinassinaturas.github.io/email-signatures/headshot-filipa-freire.png",
      host: qs("#assetHost").value.trim() || "https://growinassinaturas.github.io/email-signatures"
    });
  }

  function render(){ qs("#preview").innerHTML = signatureHTML(state); }

  function copySignature(){
    const html = signatureHTML(state);
    const tmp = document.createElement("div");
    tmp.innerHTML = html.trim();
    const table = tmp.firstElementChild;
    const range = document.createRange();
    range.selectNode(table);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    let ok=false;
    try{ok=document.execCommand("copy");}catch(e){ok=false;}
    sel.removeAllRanges();
    status(ok?"Assinatura copiada!":"Não consegui copiar automaticamente.",ok);
  }

  async function copyRawHTML(){
    const html=signatureHTML(state).trim();
    try{
      if(navigator.clipboard&&window.ClipboardItem){
        const blob=new Blob([html],{type:"text/html"});
        await navigator.clipboard.write([new ClipboardItem({"text/html":blob})]);
      }else{
        const ta=document.createElement("textarea");
        ta.value=html;document.body.appendChild(ta);ta.select();document.execCommand("copy");ta.remove();
      }
      status("HTML copiado para a área de transferência.",true);
    }catch(e){status("Não consegui copiar o HTML.",false);}
  }

  function genLink(){
    readForm();
    const base=location.origin+location.pathname;
    const u=`${base}?name=${encode(state.name)}&title=${encode(state.title)}&hobby=${encode(state.hobby)}&mobile=${encode(state.mobile)}&photo=${encode(state.photo)}&host=${encode(state.host)}`;
    navigator.clipboard?.writeText(u);
    status("Link gerado e copiado.",true);
    alert(u);
  }

  function status(msg,ok){qs("#status").innerHTML=(ok?'<span class="ok">OK</span> ':'<span class="err">Ops</span> ')+msg;}

  ["#name","#title","#hobby","#mobile","#photo","#assetHost"].forEach(id=>{
    qs(id).addEventListener("input",()=>{readForm();render();});
  });
  qs("#copyBtn").addEventListener("click",e=>{e.preventDefault();readForm();copySignature();});
  qs("#copyHtmlBtn").addEventListener("click",e=>{e.preventDefault();readForm();copyRawHTML();});
  qs("#linkBtn").addEventListener("click",e=>{e.preventDefault();genLink();});

  (function fromQuery(){
    const q=new URLSearchParams(location.search);
    if(q.get("name"))qs("#name").value=q.get("name");
    if(q.get("title"))qs("#title").value=q.get("title");
    if(q.get("hobby"))qs("#hobby").value=q.get("hobby");
    if(q.get("mobile"))qs("#mobile").value=q.get("mobile");
    if(q.get("photo"))qs("#photo").value=q.get("photo");
    if(q.get("host"))qs("#assetHost").value=q.get("host");
    readForm();render();
  })();

  render();
</script>
</body>
</html>
