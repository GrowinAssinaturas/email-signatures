<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Assinaturas Growin — Builder</title>
<style>
  body{
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif;
    margin:24px;
    color:#111;
  }
  .wrap{
    display:grid;
    grid-template-columns:360px 1fr;
    gap:24px;
    align-items:start;
  }
  label{
    display:block;
    font-size:12px;
    text-transform:uppercase;
    letter-spacing:.04em;
    color:#555;
    margin:12px 0 4px;
  }
  input,select{
    width:100%;
    padding:10px 12px;
    border:1px solid #d0d0d0;
    border-radius:8px;
    font-size:14px;
  }
  .card{
    border:1px solid #e6e6e6;
    border-radius:12px;
    padding:16px;
  }
  .btn{
    display:inline-block;
    border:0;
    border-radius:10px;
    padding:12px 14px;
    font-weight:600;
    cursor:pointer;
  }
  .btn-primary{background:#e6443b;color:#fff}
  .row{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    margin-top:12px;
  }
  .preview-wrap{
    background:#fff;
    border:1px dashed #ddd;
    border-radius:12px;
    padding:16px;
    overflow:auto;
  }
  @media (max-width:900px){
    .wrap{grid-template-columns:1fr}
  }

  /* Responsive fixes for signature preview */
  @media screen and (max-width:480px){
    .sig-wrap{font-size:70% !important;}
    .sig-col{display:block !important;width:100% !important;}
    .sig-divider{display:none !important;}
    .sig-right{text-align:center !important;}
    .sig-logo{
      max-width:170px !important;
      margin:8px auto 6px !important;
      display:block !important;
    }
    .sig-icons td{padding:0 6px !important;}
    .sig-photo{width:72px !important;height:72px !important;}
    .sig-iso{max-width:56px !important;}
  }
</style>
</head>
<body>
<h1 id="title-builder">Assinaturas Growin — Builder</h1>
<p class="muted" id="desc-builder">
  Campos personalizáveis: <strong>Nome</strong>, <strong>Cargo</strong> e <strong>Telemóvel pessoal</strong>.  
  Também podes escolher a morada do escritório.
</p>

<div class="wrap" id="builder-ui">
  <div class="card">

    <label for="office">Morada</label>
    <select id="office">
      <option value="lisboa">Lisboa — Av. da República</option>
      <option value="porto">Porto — Av. da Boavista</option>
    </select>

    <label for="name">Nome</label>
    <input id="name" value="Filipa Freire">

    <label for="title">Cargo</label>
    <input id="title" value="GRAPHIC DESIGNER">

    <label for="mobile">Telemóvel pessoal (como deve aparecer)</label>
    <input id="mobile" value="(+351) 9XX XXX XXX">

    <div class="row">
      <button id="copyBtn" class="btn btn-primary">Copiar assinatura</button>
    </div>
  </div>

  <div>
    <div class="preview-wrap">
      <div id="preview"></div>
    </div>
  </div>
</div>

<script>
const qs = s => document.querySelector(s);
function nobreak(str){return (str||"").trim().replace(/\s+/g,'&nbsp;');}
const digitsHref = s => {
  const raw=(s||"").replace(/[^\d+]/g,"");
  if(/^9\\d{8}$/.test(raw)) return "+351"+raw;
  return raw || "+3519XXXXXXXX";
};

const DEFAULT_HOST = "https://www.growin.com/signatures";
const params = new URLSearchParams(location.search);
const initialHost = params.get("host") || DEFAULT_HOST;
const MOBILE_PLACEHOLDER = "(+351) 9XX XXX XXX";

/* MAPA DE MORADAS */
const ADDRESS_MAP = {
  lisboa: "Avenida da República, 57, 4.ºdt, 1050-189, Lisboa",
  porto: "Avenida da Boavista, nº 1773, B2.5, 4100-133 Porto"
};

function signatureHTML({name,title,mobile,host,office}){
  const H = (host || DEFAULT_HOST).replace(/\/+$/,"");

  const addrKey = office && ADDRESS_MAP[office] ? office : "lisboa";
  const addressText = ADDRESS_MAP[addrKey];
  const addressNB = nobreak(addressText);

  const mobileClean = (mobile || "").trim();
  const hasMobile = !!mobileClean;

  let telHref = "";
  let mobileNB = "";
  if (hasMobile){
    telHref = digitsHref(mobileClean);
    mobileNB = nobreak(mobileClean);
  }

  const photoUrl = `${H}/sem-foto.
